#!/bin/sh
set -o posix

anisotime_version='0.0.3'

if [ -z "$KIBRARY_HOME" ]; then
  if readlink "$0" >/dev/null 2>&1; then
    KIBRARY_HOME="$(dirname "$(dirname "$("$(dirname "$(readlink "$0")")/readlink_f.sh" "$0")")")"
  else
    KIBRARY_HOME="$(dirname "$(dirname "$0")")"
  fi
  printf "KIBRARY_HOME is %s.\n" "$KIBRARY_HOME." 1>&2
fi

KIBRARY_BIN="$KIBRARY_HOME/bin"
KIBRARY=$(find "$KIBRARY_BIN" -type f -name 'kib*jar' | tail -n1)

if [ -z "$JAVA" ]; then
  JAVA='java'
  echo "JAVA is set to be 'java'. ($(command -v java))" 1>&2
fi
export JAVA

if ! "$KIBRARY_BIN/javaCheck" -r >/dev/null 2>&1; then
  "$KIBRARY_BIN/javaCheck"
  exit 1
fi

"$JAVA" -cp "$KIBRARY" io.github.kensuke1984.anisotime.ANISOtime "$@"
exit $?
