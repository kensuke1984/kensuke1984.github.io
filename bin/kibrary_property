#!/bin/sh
set -o posix

kibrth_version='0.0.1'

if [ -z "$KIBRARY_HOME" ]; then
  export KIBRARY_HOME=$(dirname "$(./readlink_f.sh "$(dirname $0)")")
  printf "KIBRARY_HOME is %s.\n" "$KIBRARY_HOME." 1>&2
fi

KIBRARY_BIN="$KIBRARY_HOME/bin"
KIBRARY=$(find "$KIBRARY_BIN" -type f -name 'kib*jar' | tail -n1)

if [ -z "$JAVA" ]; then
  JAVA='java'
  echo "JAVA is set to be 'java'. ($(command -v java))" 1>&2
fi
export JAVA

if ! "$KIBRARY_BIN/javaCheck" -r >/dev/null 2>&1; then
  "$KIBRARY_BIN/javaCheck"
  exit 1
fi

"$JAVA" -cp "$KIBRARY" io.github.kensuke1984.kibrary.Property "$@"
exit $?
